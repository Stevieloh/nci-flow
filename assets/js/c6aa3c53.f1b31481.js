"use strict";(self.webpackChunknci_flow=self.webpackChunknci_flow||[]).push([[9324],{3905:(e,t,r)=>{r.d(t,{Zo:()=>s,kt:()=>h});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var c=n.createContext({}),p=function(e){var t=n.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},s=function(e){var t=p(e.components);return n.createElement(c.Provider,{value:t},e.children)},u="mdxType",f={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,i=e.originalType,c=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),u=p(r),d=a,h=u["".concat(c,".").concat(d)]||u[d]||f[d]||i;return r?n.createElement(h,o(o({ref:t},s),{},{components:r})):n.createElement(h,o({ref:t},s))}));function h(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=r.length,o=new Array(i);o[0]=d;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l[u]="string"==typeof e?e:a,o[1]=l;for(var p=2;p<i;p++)o[p]=r[p];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},5162:(e,t,r)=>{r(7294)},3502:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>f,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var n=r(7462),a=(r(7294),r(3905));r(5162);const i={sidebar_position:4,title:"Step 3 - Creating the policies and policy redirect to the Palo Alto Firewall"},o=void 0,l={unversionedId:"VPC-L7 Integration/lab-3-configure-pbr-fw",id:"VPC-L7 Integration/lab-3-configure-pbr-fw",title:"Step 3 - Creating the policies and policy redirect to the Palo Alto Firewall",description:"Create Policy Based Redirect (PBR) in VPC",source:"@site/docs/VPC-L7 Integration/lab-3-configure-pbr-fw.md",sourceDirName:"VPC-L7 Integration",slug:"/VPC-L7 Integration/lab-3-configure-pbr-fw",permalink:"/nci-flow/docs/VPC-L7 Integration/lab-3-configure-pbr-fw",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/VPC-L7 Integration/lab-3-configure-pbr-fw.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4,title:"Step 3 - Creating the policies and policy redirect to the Palo Alto Firewall"},sidebar:"tutorialSidebar",previous:{title:"Step 2 - Configuring the Palo Alto Firewall ",permalink:"/nci-flow/docs/VPC-L7 Integration/lab-2-configure-pa-fw"},next:{title:"3.0 VLAN Based Microsegmentation",permalink:"/nci-flow/docs/category/30-vlan-based-microsegmentation"}},c={},p=[],s={toc:p},u="wrapper";function f(e){let{components:t,...r}=e;return(0,a.kt)(u,(0,n.Z)({},s,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Create Policy Based Redirect (PBR) in VPC")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Login to the Prism Central ")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Click on Infrastructure in the App Switcher")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Scroll down on the side bar to go to Network and Security")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Click on Virtual Private Clouds")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Click on the VPC that was created")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Click on the Policies Tab, by default there is already a policy rule with any-any created at priority 10. Higher priorities rules will be matched first. Thus we will need to create a rule that has a higher number in priority compared to the default one. ")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Click on Create Policies"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Priority :      30 "),(0,a.kt)("li",{parentName:"ul"},"Source :        Custom  (Specify the source ip address as 10.1.1.0/24. This is the network address for the web subnet)"),(0,a.kt)("li",{parentName:"ul"},"Destination:    Custom  (Specify the destination ip address as 20.1.1.0/24. This is the network address for the app subnet)"),(0,a.kt)("li",{parentName:"ul"},"Protocol:       Any"),(0,a.kt)("li",{parentName:"ul"},"Actions:        ReRoute",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Reroute IP:   IP Address of the Palo Alto Virtual Firewall Production NIC "))),(0,a.kt)("li",{parentName:"ul"},'Click on the checkbox "Additional Create Policy in reverse direction"'))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Click on the Create button"))),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Verify that the PBR rule is indeed forwarding traffic to the Virtual Firewall")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"From the Prism central, launch the web console to the Web Virtual Machine, login with the credentials and perform a continous ping to the App VM. Verify that the ping is successful"),(0,a.kt)("li",{parentName:"ol"},"Login to the Palo Alto Firewall"),(0,a.kt)("li",{parentName:"ol"},"Click on Monitor, go to Logs-Traffic."),(0,a.kt)("li",{parentName:"ol"},"On the top right corner, there is a dropdown box which indicates the refresh interval of the logs. You can choose to manual refresh or refresh at certain interval"),(0,a.kt)("li",{parentName:"ol"},"After the refresh is complete, you can see logs of the PING traffic from the Web VM to the App VM. Some sample is as per below screenshot")),(0,a.kt)("p",null,"This confirms that the Nutanix VPC is indeed sending traffic to the Palo Alto VM. In a real world scenario, additional rules will be applied to inspect the traffic received by the firewall. This also showcases the use of Policy Based Routing on the Nutanix VPC integration with the Palo Alto."))}f.isMDXComponent=!0}}]);